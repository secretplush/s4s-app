"use strict";(()=>{var e={};e.id=14,e.ids=[14],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6005:e=>{e.exports=require("node:crypto")},5007:(e,a,t)=>{t.r(a),t.d(a,{headerHooks:()=>v,originalPathname:()=>k,patchFetch:()=>$,requestAsyncStorage:()=>_,routeModule:()=>h,serverHooks:()=>y,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>w});var r={};t.r(r),t.d(r,{GET:()=>p,POST:()=>m,maxDuration:()=>l});var c=t(5419),o=t(9108),n=t(9678),i=t(8070),s=t(3334);let l=300,d="https://app.onlyfansapi.com/api",f=process.env.OF_API_KEY||"ofapi_bT4J1Er2YBow46EihDfjlSFf5HRmiM15M4DCOoHn7889d8b4",u={milliexhart:"acct_ebca85077e0a4b7da04cf14176466411",zoepriceee:"acct_f05bf7874c974a5d875a1ef01c5bbc3b",novaleighh:"acct_9ee32f0bac4e4e8394a09f2c9fa2fbb7",lucymonroee:"acct_0653d6e6c3984bea8d3adc84cc616c7c",chloecookk:"acct_6bb6d77ac2c741ecb54d865237bb04f4",jackiesmithh:"acct_bd6a75d6943141589cf5e43586653258",brookeewest:"acct_749c75e13d7e4685813f2a2867ce614d",ayaaann:"acct_b0b0698a614643c5932cfccd23f7c430",chloeecavalli:"acct_b5e739f9f40a4da99b2f5ca559168012",sadieeblake:"acct_cfb853d0ba714aeaa9a89e3026ec6190",lolasinclairr:"acct_bde8d615937548f18c4e54b7cedf8c1d",maddieharperr:"acct_a50799a789a6422c8389d7d055fcbd1a",zoeemonroe:"acct_fbd172e2681f4dfbb6026ce806ecaa28",biancaawoods:"acct_54e3119e77da4429b6537f7dd2883a05",aviannaarose:"acct_2648cedf59644b0993ade9608bd868a1",jessicaparkerrr:"acct_29037b1ef83d4c838ab2ec49d61d26f6",kaliblakexo:"acct_487806e5751b487bb302793ee1c3ef2c",laceythomass:"acct_c85c710e083f4b4a94d826f76855543d",lindamarievip:"acct_04d878af1813422fa6b310991f687d73",lilyyymonroee:"acct_e84886b3217e4fbd8f82ee63ca8894e8",dollyrhodesss:"acct_bfd09358f67849cba6d9f8cf4a565cd2",chelseapaige:"acct_b5f1a5fc3cfd4a959dbea7230814ae71",thesarasky:"acct_8b4b062aeef1441ba8f51a7b0f3fe5f2",yourrfavblondie:"acct_15870053c2604e0f9e94d14a10749923",skyyroseee:"acct_7a273714a275417992b0f7c1d3389a2c",tyybabyy:"acct_766a8451ee6946009d20581ab11fdfc4",itsmealexisrae:"acct_ac70731a489741f0b6abc45a050f0301",lolaxmae:"acct_40e51b831b3247ac806755362b494fe5",rebeccabrownn:"acct_6f2328ebe4c446038ea1847d2dbecc17",oliviabrookess:"acct_9665889fec2b46e9a05232afee59ef19"};async function b(e,a,t,r){let c=u[e];if(!c)return{vaultId:null,error:`No account ID for ${e}`};try{let{buffer:e,mimeType:o}=function(e){let a=e.match(/^data:(.+);base64,(.+)$/);if(!a)throw Error("Invalid base64 data URL");return{mimeType:a[1],buffer:Buffer.from(a[2],"base64")}}(a),n=new FormData,i=new Blob([e],{type:o});n.append("file",i,t);let s=await fetch(`${d}/${c}/media/upload`,{method:"POST",headers:{Authorization:`Bearer ${f}`},body:n});if(!s.ok)return{vaultId:null,error:`Upload failed: ${await s.text()}`};let l=await s.json(),u=l.prefixed_id||l.id||l.media_id;if(!u)return{vaultId:null,error:`No media ID: ${JSON.stringify(l)}`};await new Promise(e=>setTimeout(e,11e3));let b=await fetch(`${d}/${c}/posts`,{method:"POST",headers:{Authorization:`Bearer ${f}`,"Content-Type":"application/json"},body:JSON.stringify({text:`@${r}`,mediaFiles:[u]})});if(!b.ok)return{vaultId:null,error:`Post failed: ${await b.text()}`};let m=await b.json(),p=m.data||m,h=p.id||p.post_id,_=null;if(p.media&&p.media.length>0&&(_=p.media[0].id?.toString()||p.media[0].vault_id?.toString()),h&&(await new Promise(e=>setTimeout(e,2e3)),await fetch(`${d}/${c}/posts/${h}`,{method:"DELETE",headers:{Authorization:`Bearer ${f}`}})),!_)return{vaultId:null,error:"Could not extract vault_id"};return{vaultId:_}}catch(e){return{vaultId:null,error:`Exception: ${e}`}}}async function m(e){try{let{targetUsername:a,sources:t}=await e.json();if(!a||!t||0===t.length)return i.Z.json({error:"Missing targetUsername or sources"},{status:400});if(!u[a])return i.Z.json({error:`Unknown target model: ${a}`},{status:400});let r=[];for(let e=0;e<t.length;e++){let c=t[e];console.log(`[sync-new-model] ${e+1}/${t.length}: Uploading ${c.username}'s image to ${a}'s vault...`);let{vaultId:o,error:n}=await b(a,c.imageBase64,c.filename,c.username);r.push({username:c.username,vaultId:o,error:n})}let c=await s.kv.get("vault_mappings")||{};for(let e of r)e.vaultId&&(c[e.username]||(c[e.username]={}),c[e.username][a]=e.vaultId);await s.kv.set("vault_mappings",c),await s.kv.set("last_sync",new Date().toISOString());let o=r.filter(e=>null!==e.vaultId),n=r.filter(e=>null===e.vaultId);return i.Z.json({success:!0,targetUsername:a,total:t.length,successful:o.length,failed:n.length,results:r})}catch(e){return console.error("Sync new model error:",e),i.Z.json({error:String(e)},{status:500})}}async function p(e){let a=e.nextUrl.searchParams.get("target");if(!a)return i.Z.json({error:"Missing target param"},{status:400});let t=await s.kv.get("vault_mappings")||{},r=Object.keys(u),c=r.filter(e=>e!==a),o=[],n=[];for(let e of c)t[e]?.[a]?n.push({username:e,vaultId:t[e][a]}):o.push(e);return i.Z.json({targetUsername:a,totalModels:r.length,missing:o,missingCount:o.length,existing:n,existingCount:n.length})}let h=new c.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/sync-new-model/route",pathname:"/api/sync-new-model",filename:"route",bundlePath:"app/api/sync-new-model/route"},resolvedPagePath:"/Users/moltplush/.openclaw/workspace/s4s-app/app/api/sync-new-model/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:_,staticGenerationAsyncStorage:g,serverHooks:y,headerHooks:v,staticGenerationBailout:w}=h,k="/api/sync-new-model/route";function $(){return(0,n.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:g})}}};var a=require("../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),r=a.X(0,[638,206,334],()=>t(5007));module.exports=r})();
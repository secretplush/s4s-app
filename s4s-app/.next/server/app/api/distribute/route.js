"use strict";(()=>{var e={};e.id=501,e.ids=[501],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6005:e=>{e.exports=require("node:crypto")},5010:(e,a,t)=>{t.r(a),t.d(a,{headerHooks:()=>y,originalPathname:()=>g,patchFetch:()=>$,requestAsyncStorage:()=>h,routeModule:()=>m,serverHooks:()=>v,staticGenerationAsyncStorage:()=>_,staticGenerationBailout:()=>w});var r={};t.r(r),t.d(r,{POST:()=>p,maxDuration:()=>n});var c=t(5419),o=t(9108),i=t(9678),d=t(8070),l=t(3334);let n=300,s="https://app.onlyfansapi.com/api",f=process.env.OF_API_KEY||"ofapi_bT4J1Er2YBow46EihDfjlSFf5HRmiM15M4DCOoHn7889d8b4",u={milliexhart:"acct_ebca85077e0a4b7da04cf14176466411",zoepriceee:"acct_f05bf7874c974a5d875a1ef01c5bbc3b",novaleighh:"acct_9ee32f0bac4e4e8394a09f2c9fa2fbb7",lucymonroee:"acct_0653d6e6c3984bea8d3adc84cc616c7c",chloecookk:"acct_6bb6d77ac2c741ecb54d865237bb04f4",jackiesmithh:"acct_bd6a75d6943141589cf5e43586653258",brookeewest:"acct_749c75e13d7e4685813f2a2867ce614d",ayaaann:"acct_b0b0698a614643c5932cfccd23f7c430",chloeecavalli:"acct_b5e739f9f40a4da99b2f5ca559168012",sadieeblake:"acct_cfb853d0ba714aeaa9a89e3026ec6190",lolasinclairr:"acct_bde8d615937548f18c4e54b7cedf8c1d",maddieharperr:"acct_a50799a789a6422c8389d7d055fcbd1a",zoeemonroe:"acct_fbd172e2681f4dfbb6026ce806ecaa28",biancaawoods:"acct_54e3119e77da4429b6537f7dd2883a05",aviannaarose:"acct_2648cedf59644b0993ade9608bd868a1",jessicaparkerrr:"acct_29037b1ef83d4c838ab2ec49d61d26f6",kaliblakexo:"acct_487806e5751b487bb302793ee1c3ef2c",laceythomass:"acct_c85c710e083f4b4a94d826f76855543d",lindamarievip:"acct_04d878af1813422fa6b310991f687d73",lilyyymonroee:"acct_e84886b3217e4fbd8f82ee63ca8894e8",dollyrhodesss:"acct_bfd09358f67849cba6d9f8cf4a565cd2",chelseapaige:"acct_b5f1a5fc3cfd4a959dbea7230814ae71",thesarasky:"acct_8b4b062aeef1441ba8f51a7b0f3fe5f2",yourrfavblondie:"acct_15870053c2604e0f9e94d14a10749923",skyyroseee:"acct_7a273714a275417992b0f7c1d3389a2c",tyybabyy:"acct_766a8451ee6946009d20581ab11fdfc4",itsmealexisrae:"acct_ac70731a489741f0b6abc45a050f0301",lolaxmae:"acct_40e51b831b3247ac806755362b494fe5",rebeccabrownn:"acct_6f2328ebe4c446038ea1847d2dbecc17",oliviabrookess:"acct_9665889fec2b46e9a05232afee59ef19"};async function b(e,a,t,r){let c=u[e];if(!c)return{vaultId:null,error:`No account ID for ${e}`};try{let{buffer:e,mimeType:o}=function(e){let a=e.match(/^data:(.+);base64,(.+)$/);if(!a)throw Error("Invalid base64 data URL");return{mimeType:a[1],buffer:Buffer.from(a[2],"base64")}}(a),i=new FormData,d=new Blob([e],{type:o});i.append("file",d,t);let l=await fetch(`${s}/${c}/media/upload`,{method:"POST",headers:{Authorization:`Bearer ${f}`},body:i});if(!l.ok){let e=await l.text();return{vaultId:null,error:`Upload failed: ${e}`}}let n=await l.json(),u=n.prefixed_id||n.id||n.media_id;if(!u)return{vaultId:null,error:`No media ID returned from upload: ${JSON.stringify(n)}`};await new Promise(e=>setTimeout(e,11e3));let b=await fetch(`${s}/${c}/posts`,{method:"POST",headers:{Authorization:`Bearer ${f}`,"Content-Type":"application/json"},body:JSON.stringify({text:`@${r}`,mediaFiles:[u]})});if(!b.ok){let e=await b.text();return{vaultId:null,error:`Post creation failed: ${e}`}}let p=await b.json(),m=p.data||p,h=m.id||m.post_id,_=null;if(m.media&&m.media.length>0&&(_=m.media[0].id?.toString()||m.media[0].vault_id?.toString()),h){await new Promise(e=>setTimeout(e,2e3));let e=await fetch(`${s}/${c}/posts/${h}`,{method:"DELETE",headers:{Authorization:`Bearer ${f}`}});e.ok||console.error(`Failed to delete post ${h}: ${await e.text()}`)}if(!_)return{vaultId:null,error:"Could not extract vault_id from post"};return{vaultId:_}}catch(e){return{vaultId:null,error:`Exception: ${e}`}}}async function p(e){try{let{imageBase64:a,filename:t,sourceUsername:r,targetUsernames:c}=await e.json();if(!a||!c||0===c.length)return d.Z.json({error:"Missing required fields"},{status:400});let o=c.map(async(e,c)=>{await new Promise(e=>setTimeout(e,1e3*c)),console.log(`Distributing to ${e}...`);let{vaultId:o,error:i}=await b(e,a,t,r);return{username:e,vaultId:o,error:i}}),i=await Promise.all(o),n=i.filter(e=>null!==e.vaultId),s=i.filter(e=>null===e.vaultId);if(n.length>0)try{let e=await l.kv.get("vault_mappings")||{};for(let a of(e[r]||(e[r]={}),n))e[r][a.username]=a.vaultId;await l.kv.set("vault_mappings",e),console.log(`Saved ${n.length} vault mappings for ${r} to KV`)}catch(e){console.error("Failed to save vault mappings to KV:",e)}return d.Z.json({success:!0,sourceUsername:r,distributed:n.length,failed:s.length,results:i})}catch(e){return console.error("Distribution error:",e),d.Z.json({error:String(e)},{status:500})}}let m=new c.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/distribute/route",pathname:"/api/distribute",filename:"route",bundlePath:"app/api/distribute/route"},resolvedPagePath:"/Users/moltplush/.openclaw/workspace/s4s-app/app/api/distribute/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:h,staticGenerationAsyncStorage:_,serverHooks:v,headerHooks:y,staticGenerationBailout:w}=m,g="/api/distribute/route";function $(){return(0,i.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:_})}}};var a=require("../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),r=a.X(0,[638,206,334],()=>t(5010));module.exports=r})();
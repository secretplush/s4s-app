(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[350],{8280:function(e,t,a){Promise.resolve().then(a.bind(a,171))},171:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return i}});var s=a(3827),n=a(4090),r=a(8792),l=a(6737),c=a(251);function i(){let[e,t]=(0,n.useState)(null),[a,i]=(0,n.useState)(!1),[o,d]=(0,n.useState)(!1),[u,m]=(0,n.useState)(null),[h,g]=(0,n.useState)(null),[b,f]=(0,n.useState)(!0),p=(0,n.useCallback)(async()=>{try{let e=await fetch("/api/rotation/control"),a=await e.json();t(a)}catch(e){console.error("Failed to fetch status:",e)}finally{f(!1)}},[]);(0,n.useEffect)(()=>{p();let e=setInterval(p,1e4);return()=>clearInterval(e)},[p]);let x=async()=>{i(!0),m(null);try{let e={},t=[];for(let a of l.aT)for(let s of(t.push({id:a.id,username:a.username}),await (0,c.lL)(a.username)))if(s.isActive&&s.vaultIds)for(let[t,n]of Object.entries(s.vaultIds))e[t]||(e[t]={}),e[t][a.username]=n;let a=await fetch("/api/sync/vault-mappings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mappings:e,models:t})}),s=await a.json();s.success?m("✅ Synced ".concat(s.modelCount," models with ").concat(s.totalVaultIds," vault mappings")):m("❌ ".concat(s.error))}catch(e){m("❌ Error: ".concat(e))}finally{i(!1)}},y=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:14;d(!0),g(null);try{let t=await fetch("/api/schedule/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({days:e})}),a=await t.json();a.success?(g("✅ Generated ".concat(a.totalSlots," tags over ").concat(a.days," days (~").concat(a.avgPerDay,"/day)")),p()):g("❌ ".concat(a.error))}catch(e){g("❌ Error: ".concat(e))}finally{d(!1)}},v=async e=>{try{let t=await fetch("/api/rotation/control",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:e})});await t.json(),p()}catch(e){console.error("Control error:",e)}},j=async()=>{try{let e=await fetch("/api/cron/tick"),t=await e.json();console.log("Manual tick result:",t),p()}catch(e){console.error("Tick error:",e)}};return b?(0,s.jsx)("main",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 p-8 flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-white text-xl",children:"Loading..."})}):(0,s.jsx)("main",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-purple-900 to-gray-900 p-8",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(r.default,{href:"/",className:"text-purple-400 hover:text-purple-300 mb-2 inline-block",children:"← Back to Dashboard"}),(0,s.jsx)("h1",{className:"text-3xl font-bold text-white",children:"\uD83C\uDF9B️ Rotation Control Panel"}),(0,s.jsx)("p",{className:"text-gray-400",children:"Set it and forget it — runs autonomously"})]}),(0,s.jsx)("div",{className:"px-4 py-2 rounded-full text-lg font-bold ".concat((null==e?void 0:e.active)?"bg-green-600 text-white animate-pulse":"bg-gray-600 text-gray-300"),children:(null==e?void 0:e.active)?"\uD83D\uDFE2 RUNNING":"⏸️ PAUSED"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8",children:[(0,s.jsxs)("div",{className:"bg-gray-800/50 rounded-lg p-4 border border-gray-700",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-white",children:(null==e?void 0:e.totalSlots)||0}),(0,s.jsx)("div",{className:"text-gray-400 text-sm",children:"Total Scheduled"})]}),(0,s.jsxs)("div",{className:"bg-gray-800/50 rounded-lg p-4 border border-gray-700",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-green-400",children:(null==e?void 0:e.executed)||0}),(0,s.jsx)("div",{className:"text-gray-400 text-sm",children:"Executed"})]}),(0,s.jsxs)("div",{className:"bg-gray-800/50 rounded-lg p-4 border border-gray-700",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-yellow-400",children:(null==e?void 0:e.remaining)||0}),(0,s.jsx)("div",{className:"text-gray-400 text-sm",children:"Remaining"})]}),(0,s.jsxs)("div",{className:"bg-gray-800/50 rounded-lg p-4 border border-gray-700",children:[(0,s.jsx)("div",{className:"text-2xl font-bold text-purple-400",children:(null==e?void 0:e.pendingDeletions)||0}),(0,s.jsx)("div",{className:"text-gray-400 text-sm",children:"Pending Deletes"})]})]}),(0,s.jsxs)("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700 mb-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-white mb-4",children:"\uD83D\uDCCB Setup Steps"}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-white",children:"1. Sync Vault Mappings"}),(0,s.jsx)("p",{className:"text-gray-400 text-sm",children:"Push your local vault IDs to the server"})]}),(0,s.jsx)("button",{onClick:x,disabled:a,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium disabled:opacity-50",children:a?"⏳ Syncing...":"\uD83D\uDCE4 Sync Now"})]}),u&&(0,s.jsx)("div",{className:"p-3 rounded-lg text-sm ".concat(u.includes("✅")?"bg-green-900/30 text-green-400":"bg-red-900/30 text-red-400"),children:u})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-white",children:"2. Generate 14-Day Schedule"}),(0,s.jsx)("p",{className:"text-gray-400 text-sm",children:"Create the rotation plan"})]}),(0,s.jsx)("button",{onClick:()=>y(14),disabled:o,className:"px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white rounded-lg font-medium disabled:opacity-50",children:o?"⏳ Generating...":"\uD83D\uDCC5 Generate"})]}),h&&(0,s.jsx)("div",{className:"p-3 rounded-lg text-sm ".concat(h.includes("✅")?"bg-green-900/30 text-green-400":"bg-red-900/30 text-red-400"),children:h}),(null==e?void 0:e.scheduleGeneratedAt)&&(0,s.jsxs)("div",{className:"text-gray-500 text-xs mt-1",children:["Last generated: ",new Date(e.scheduleGeneratedAt).toLocaleString()]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-white",children:"3. Start Rotation"}),(0,s.jsx)("p",{className:"text-gray-400 text-sm",children:"Begin autonomous posting"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(null==e?void 0:e.active)?(0,s.jsx)("button",{onClick:()=>v("stop"),className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium",children:"⏹️ Stop"}):(0,s.jsx)("button",{onClick:()=>v("start"),disabled:!(null==e?void 0:e.totalSlots),className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium disabled:opacity-50",children:"▶️ Start"}),(0,s.jsx)("button",{onClick:j,className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg font-medium",title:"Manually trigger one tick",children:"\uD83D\uDD04 Manual Tick"})]})]}),(null==e?void 0:e.lastTick)&&(0,s.jsxs)("div",{className:"text-gray-500 text-xs",children:["Last tick: ",new Date(e.lastTick).toLocaleString()]})]})]}),(0,s.jsxs)("div",{className:"bg-yellow-900/20 border border-yellow-700/50 rounded-xl p-6 mb-6",children:[(0,s.jsx)("h3",{className:"text-lg font-bold text-yellow-400 mb-2",children:"⚠️ External Cron Required"}),(0,s.jsx)("p",{className:"text-gray-300 mb-3",children:'For true "set and forget", set up a free cron service to ping this URL every minute:'}),(0,s.jsx)("code",{className:"block bg-black/50 p-3 rounded text-green-400 text-sm mb-3 break-all",children:"GET https://s4s-app.vercel.app/api/cron/tick"}),(0,s.jsxs)("p",{className:"text-gray-400 text-sm",children:["Recommended: ",(0,s.jsx)("a",{href:"https://cron-job.org",target:"_blank",className:"text-blue-400 hover:underline",children:"cron-job.org"})," (free) or ",(0,s.jsx)("a",{href:"https://easycron.com",target:"_blank",className:"text-blue-400 hover:underline",children:"EasyCron"})]})]}),(null==e?void 0:e.recentActivity)&&e.recentActivity.length>0&&(0,s.jsxs)("div",{className:"bg-gray-800/50 rounded-xl p-6 border border-gray-700",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-white mb-4",children:"\uD83D\uDCCA Recent Activity"}),(0,s.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:e.recentActivity.map((e,t)=>(0,s.jsx)("div",{className:"bg-gray-700/30 rounded-lg p-3 text-sm",children:(0,s.jsxs)("div",{className:"flex justify-between text-gray-400",children:[(0,s.jsx)("span",{children:new Date(e.timestamp).toLocaleString()}),(0,s.jsxs)("span",{children:["✅ ",e.tagsExecuted," tags | \uD83D\uDDD1️ ",e.postsDeleted," deleted"]})]})},t))})]}),(0,s.jsx)("div",{className:"mt-6 text-center",children:(0,s.jsx)("button",{onClick:()=>{confirm("Reset all schedule data? This cannot be undone.")&&v("reset")},className:"text-red-400 hover:text-red-300 text-sm",children:"\uD83D\uDDD1️ Reset All Schedule Data"})})]})})}},251:function(e,t,a){"use strict";a.d(t,{EY:function(){return l},TU:function(){return i},lL:function(){return r},xA:function(){return c},yn:function(){return d}});let s="promo_images";function n(){return new Promise((e,t)=>{let a=indexedDB.open("s4s_promo_db",1);a.onerror=()=>t(a.error),a.onsuccess=()=>e(a.result),a.onupgradeneeded=e=>{let t=e.target.result;t.objectStoreNames.contains(s)||t.createObjectStore(s,{keyPath:"username"})}})}async function r(e){try{let t=await n();return new Promise((a,n)=>{let r=t.transaction(s,"readonly").objectStore(s).get(e);r.onerror=()=>n(r.error),r.onsuccess=()=>{let e=r.result;a((null==e?void 0:e.images)||[])}})}catch(t){return console.error("Failed to load from IndexedDB:",t),function(e){try{let t=localStorage.getItem("s4s_promo_images");if(!t)return[];return JSON.parse(t)[e]||[]}catch(e){return[]}}(e)}}async function l(e,t){try{let a=await n();return new Promise((n,r)=>{let l=a.transaction(s,"readwrite").objectStore(s).put({username:e,images:t});l.onerror=()=>r(l.error),l.onsuccess=()=>n()})}catch(e){throw console.error("Failed to save to IndexedDB:",e),e}}async function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;try{let t=await n();return new Promise((a,n)=>{let r=t.transaction(s,"readonly").objectStore(s).getAll();r.onerror=()=>n(r.error),r.onsuccess=()=>{let t={},s=e-1;for(let e of r.result){let a=e.images.filter(e=>e.isActive),n=!1,r=s,l=0;for(let e of a){let t=Object.keys(e.vaultIds||{}).length;t<s&&(n=!0),r=Math.min(r,t),l=Math.max(l,t)}let c="";0===a.length?(c="No active images",n=!0):c=n?"".concat(r,"/").concat(s," vaults"):"✓ All ".concat(s," vaults"),t[e.username]={total:e.images.length,active:a.length,needsDistribution:n,vaultStatus:c}}a(t)}})}catch(e){return console.error("Failed to get image counts:",e),{}}}async function i(){try{let e=localStorage.getItem("s4s_promo_images");if(!e)return 0;let t=JSON.parse(e),a=0;for(let[e,s]of Object.entries(t))s&&s.length>0&&(await l(e,s),a+=s.length);return a>0&&(localStorage.removeItem("s4s_promo_images"),console.log("Migrated ".concat(a," images from localStorage to IndexedDB"))),a}catch(e){return console.error("Migration failed:",e),0}}async function o(){try{let e=await n();return new Promise((t,a)=>{let n=e.transaction(s,"readonly").objectStore(s).getAll();n.onerror=()=>a(n.error),n.onsuccess=()=>{let e={},a=[];for(let t of n.result)for(let s of(a.push(t.username),t.images))if(s.isActive)for(let[a,n]of Object.entries(s.vaultIds||{}))e[a]||(e[a]={}),e[a][t.username]=n;t({mappings:e,models:a})}})}catch(e){return console.error("Failed to export vault mappings:",e),{mappings:{},models:[]}}}async function d(){try{let{mappings:e,models:t}=await o(),a=await fetch("/api/sync/vault-mappings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mappings:e,models:t})}),s=await a.json();if(s.success)return{success:!0,message:"Synced ".concat(t.length," models with ").concat(s.totalVaultIds," vault mappings")};return{success:!1,message:s.error||"Sync failed"}}catch(e){return{success:!1,message:String(e)}}}},6737:function(e,t,a){"use strict";function s(e){return 0===e.fans?0:e.totalEarnings/e.fans}a.d(t,{aT:function(){return n},c$:function(){return r},uM:function(){return s}});let n=[{id:"acct_ebca85077e0a4b7da04cf14176466411",username:"milliexhart",displayName:"Millie Hart",fans:2547,likes:1141,avatar:"https://thumbs.onlyfans.com/public/files/thumbs/c144/i/im/imm/immx4rrlkhilts5dh39x83bedpl6wyng1768418465/544695119/avatar.jpg",connected:!0,totalEarnings:7408.18},{id:"acct_f05bf7874c974a5d875a1ef01c5bbc3b",username:"zoepriceee",displayName:"Zoe Price",fans:3619,likes:1267,avatar:"https://thumbs.onlyfans.com/public/files/thumbs/c144/m/md/mdn/mdnhc1nz9ox94ihg7u16t8rhyjv6jged1768087936/544182349/avatar.jpg",connected:!0,totalEarnings:9141.66},{id:"acct_9ee32f0bac4e4e8394a09f2c9fa2fbb7",username:"novaleighh",displayName:"Nova Leigh",fans:3368,likes:1603,avatar:"https://thumbs.onlyfans.com/public/files/thumbs/c144/i/ie/ie0/ie0meiwycqhcehkd78v4l9dbnaxw1z6y1768093624/543468095/avatar.jpg",connected:!0,totalEarnings:11754.34},{id:"acct_0653d6e6c3984bea8d3adc84cc616c7c",username:"lucymonroee",displayName:"Lucy Monroe",fans:1129,likes:441,avatar:"https://thumbs.onlyfans.com/public/files/thumbs/c144/s/sq/sqp/sqpf8x4pmbvxrnymrxfypbed1mfpuk2e1769621307/543659016/avatar.jpg",connected:!0,totalEarnings:2454.68},{id:"acct_6bb6d77ac2c741ecb54d865237bb04f4",username:"chloecookk",displayName:"Chloe Cook",fans:7541,likes:4519,avatar:"https://thumbs.onlyfans.com/public/files/thumbs/c144/m/md/mdl/mdlfvy5r0vparh7hhfajc6t6jk9ol6al1767766776/543655743/avatar.jpg",connected:!0,totalEarnings:55865.34},{id:"acct_bd6a75d6943141589cf5e43586653258",username:"jackiesmithh",displayName:"Jackie Smith",fans:1570,likes:1026,avatar:"https://thumbs.onlyfans.com/public/files/thumbs/c144/e/e9/e9m/e9m0roaeabodtursjgckicnhxqxdtizv1759783375/527476418/avatar.jpg",connected:!0,totalEarnings:4886.94},{id:"acct_749c75e13d7e4685813f2a2867ce614d",username:"brookeewest",displayName:"Brooke West",fans:2462,likes:1676,avatar:"https://thumbs.onlyfans.com/public/files/thumbs/c144/r/rl/rlu/rluvlnnlbfqerqrp91eg7jsfpxjlf3a31762104304/531889164/avatar.jpg",connected:!0,totalEarnings:7298.48},{id:"acct_b0b0698a614643c5932cfccd23f7c430",username:"ayaaann",displayName:"Aya Ann",fans:7113,likes:7190,avatar:"https://thumbs.onlyfans.com/public/files/thumbs/c144/s/sc/scq/scqnyfycb5bif9h3ocalfv18m2xdtxud1758769408/525242883/avatar.jpg",connected:!0,totalEarnings:32150.95},{id:"acct_b5e739f9f40a4da99b2f5ca559168012",username:"chloeecavalli",displayName:"Chloe Cavalli",fans:3294,likes:1812,avatar:"https://thumbs.onlyfans.com/public/files/thumbs/c144/a/aw/awu/awuql1oyh5f663gf75tycuv5s9ipephj1766518426/537028788/avatar.jpg",connected:!0,totalEarnings:10089.31},{id:"acct_cfb853d0ba714aeaa9a89e3026ec6190",username:"sadieeblake",displayName:"Sadie Blake",fans:29749,likes:33331,avatar:"https://thumbs.onlyfans.com/public/files/thumbs/c144/z/zw/zwk/zwkype5jeyivmb287n1ba6yd6wmfvdgr1764902344/526616700/avatar.jpg",connected:!0,totalEarnings:212170.56},{id:"acct_bde8d615937548f18c4e54b7cedf8c1d",username:"lolasinclairr",displayName:"Lola Sinclair",fans:4815,likes:2211,avatar:"https://thumbs.onlyfans.com/public/files/thumbs/c144/3/3p/3pt/3ptchepy7oro0ypbpnjpiydd4ancwno91769395473/543872404/avatar.jpg",connected:!0,totalEarnings:14463.57},{id:"acct_a50799a789a6422c8389d7d055fcbd1a",username:"maddieharperr",displayName:"Maddie Harper",fans:4400,likes:3338,avatar:"https://thumbs.onlyfans.com/public/files/thumbs/c144/s/se/seq/seqtznbuzdeuvuyq0rqx8jdhilxqbefp1762004551/529687791/avatar.jpg",connected:!0,totalEarnings:28263.34},{id:"acct_fbd172e2681f4dfbb6026ce806ecaa28",username:"zoeemonroe",displayName:"Zoe Monroe",fans:10177,likes:12251,avatar:"https://thumbs.onlyfans.com/public/files/thumbs/c144/u/u3/u3v/u3vqfnlgcrqkgue7rbt5r0xjpkua0fuw1757346851/522110263/avatar.jpg",connected:!0,totalEarnings:47298.83},{id:"acct_54e3119e77da4429b6537f7dd2883a05",username:"biancaawoods",displayName:"Bianca Woods",fans:7453,likes:4762,avatar:"https://thumbs.onlyfans.com/public/files/thumbs/c144/3/3m/3mm/3mmvdpvsmezdphq6mpdqxwy3wl0wf1kg1762789515/525755724/avatar.jpg",connected:!0,totalEarnings:45993.3},{id:"acct_2648cedf59644b0993ade9608bd868a1",username:"aviannaarose",displayName:"Avianna Rose",fans:2649,likes:2514,avatar:"https://thumbs.onlyfans.com/public/files/thumbs/c144/r/rn/rnd/rndb0kveiej4fnsrgrakmbiuy2iktzki1762744168/532745754/avatar.jpg",connected:!0,totalEarnings:20613.97}],r={totalModels:15,totalFans:n.reduce((e,t)=>e+t.fans,0),totalLikes:n.reduce((e,t)=>e+t.likes,0),totalEarnings:n.reduce((e,t)=>e+t.totalEarnings,0),avgLTV:n.reduce((e,t)=>e+t.totalEarnings,0)/n.reduce((e,t)=>e+t.fans,0)||0,topPerformer:n.reduce((e,t)=>t.fans>e.fans?t:e,n[0]),topEarner:n.reduce((e,t)=>t.totalEarnings>e.totalEarnings?t:e,n[0])}}},function(e){e.O(0,[792,971,69,744],function(){return e(e.s=8280)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[561],{8404:function(e,t,a){Promise.resolve().then(a.bind(a,1738))},1738:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var n=a(3827),r=a(4090),s=a(8792);let o="models";function c(){return new Promise((e,t)=>{let a=indexedDB.open("s4s-network",1);a.onerror=()=>t(a.error),a.onsuccess=()=>e(a.result),a.onupgradeneeded=e=>{let t=e.target.result;t.objectStoreNames.contains(o)||t.createObjectStore(o,{keyPath:"username"})}})}async function l(){let e=await c();return new Promise((t,a)=>{let n=e.transaction(o,"readonly").objectStore(o).getAll();n.onerror=()=>a(n.error),n.onsuccess=()=>t(n.result||[])})}async function i(e){let t=await c();return new Promise((a,n)=>{let r=t.transaction(o,"readwrite").objectStore(o).put(e);r.onerror=()=>n(r.error),r.onsuccess=()=>a()})}async function d(e){let t=await c();return new Promise((a,n)=>{let r=t.transaction(o,"readwrite").objectStore(o).delete(e);r.onerror=()=>n(r.error),r.onsuccess=()=>a()})}async function u(){if(!((await l()).length>0))for(let e of[{username:"milliexhart",displayName:"Millie Hart",accountId:"acct_ebca85077e0a4b7da04cf14176466411",inRotation:!0,addedAt:new Date().toISOString()},{username:"zoepriceee",displayName:"Zoe Price",accountId:"acct_f05bf7874c974a5d875a1ef01c5bbc3b",inRotation:!0,addedAt:new Date().toISOString()},{username:"novaleighh",displayName:"Nova Leigh",accountId:"acct_9ee32f0bac4e4e8394a09f2c9fa2fbb7",inRotation:!0,addedAt:new Date().toISOString()},{username:"lucymonroee",displayName:"Lucy Monroe",accountId:"acct_0653d6e6c3984bea8d3adc84cc616c7c",inRotation:!0,addedAt:new Date().toISOString()},{username:"chloecookk",displayName:"Chloe Cook",accountId:"acct_6bb6d77ac2c741ecb54d865237bb04f4",inRotation:!0,addedAt:new Date().toISOString()},{username:"jackiesmithh",displayName:"Jackie Smith",accountId:"acct_bd6a75d6943141589cf5e43586653258",inRotation:!0,addedAt:new Date().toISOString()},{username:"brookeewest",displayName:"Brooke West",accountId:"acct_749c75e13d7e4685813f2a2867ce614d",inRotation:!0,addedAt:new Date().toISOString()},{username:"ayaaann",displayName:"Aya",accountId:"acct_b0b0698a614643c5932cfccd23f7c430",inRotation:!0,addedAt:new Date().toISOString()},{username:"chloeecavalli",displayName:"Chloe Cavalli",accountId:"acct_b5e739f9f40a4da99b2f5ca559168012",inRotation:!0,addedAt:new Date().toISOString()},{username:"sadieeblake",displayName:"Sadie Blake",accountId:"acct_cfb853d0ba714aeaa9a89e3026ec6190",inRotation:!0,addedAt:new Date().toISOString()},{username:"lolasinclairr",displayName:"Lola Sinclair",accountId:"acct_bde8d615937548f18c4e54b7cedf8c1d",inRotation:!0,addedAt:new Date().toISOString()},{username:"maddieharperr",displayName:"Maddie Harper",accountId:"acct_a50799a789a6422c8389d7d055fcbd1a",inRotation:!0,addedAt:new Date().toISOString()},{username:"zoeemonroe",displayName:"Zoe Monroe",accountId:"acct_fbd172e2681f4dfbb6026ce806ecaa28",inRotation:!0,addedAt:new Date().toISOString()},{username:"biancaawoods",displayName:"Bianca Woods",accountId:"acct_54e3119e77da4429b6537f7dd2883a05",inRotation:!0,addedAt:new Date().toISOString()},{username:"aviannaarose",displayName:"Avianna Rose",accountId:"acct_2648cedf59644b0993ade9608bd868a1",inRotation:!0,addedAt:new Date().toISOString()}])await i(e)}var m=a(251);function g(){let[e,t]=(0,r.useState)([]),[a,o]=(0,r.useState)(!0),[c,g]=(0,r.useState)(null),[x,p]=(0,r.useState)(!1),[b,h]=(0,r.useState)({username:"",displayName:"",email:"",password:""}),[y,f]=(0,r.useState)(!1),[N,w]=(0,r.useState)(null),[j,v]=(0,r.useState)(null),[I,S]=(0,r.useState)(null),A=async()=>{S({type:"loading",message:"Syncing to KV..."});let e=await (0,m.yn)();S({type:e.success?"success":"error",message:e.message}),setTimeout(()=>S(null),5e3)};(0,r.useEffect)(()=>{(async()=>{await u(),t((await l()).sort((e,t)=>e.username.localeCompare(t.username))),o(!1)})(),fetch("/api/credits").then(e=>e.json()).then(e=>{e.balance&&g(e)}).catch(console.error)},[]);let k=async a=>{let n=e.find(e=>e.username===a);if(!n)return;let r={...n,inRotation:!n.inRotation};await i(r),t(e=>e.map(e=>e.username===a?r:e))},C=async()=>{if(!b.username||!b.displayName||!b.email||!b.password){v("All fields are required");return}f(!0),w("Connecting to OnlyFans API..."),v(null);try{let e=await fetch("/api/connect-account",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:b.email,password:b.password})}),a=await e.json();if(!e.ok||"error"===a.status){v(a.error||"Failed to connect account"),f(!1),w(null);return}if(a.needs2fa){w("2FA required - check the OnlyFans API dashboard to complete verification"),f(!1);return}let n=a.accountId;if(!n){v("Connected but no account ID returned - check API dashboard"),f(!1),w(null);return}w("Connected! Saving model...");let r={username:b.username.toLowerCase().replace("@",""),displayName:b.displayName,accountId:n,inRotation:!0,addedAt:new Date().toISOString()};await i(r),t(e=>[...e,r].sort((e,t)=>e.username.localeCompare(t.username))),h({username:"",displayName:"",email:"",password:""}),p(!1),w(null)}catch(e){v(e.message||"Connection failed")}finally{f(!1)}},D=async e=>{confirm("Remove @".concat(e," from network?"))&&(await d(e),t(t=>t.filter(t=>t.username!==e)))},O=async a=>{let n=prompt("Enter OnlyFans email for @".concat(a,":"));if(!n)return;let r=prompt("Enter OnlyFans password for @".concat(a,":"));if(!r)return;let s=e.find(e=>e.username===a);if(s){t(e=>e.map(e=>e.username===a?{...e,accountId:"connecting..."}:e));try{let e=await fetch("/api/connect-account",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:r})}),o=await e.json();if(!e.ok||"error"===o.status){alert("Failed to connect: ".concat(o.error)),t(e=>e.map(e=>e.username===a?{...e,accountId:null}:e));return}if(o.needs2fa){alert("2FA required - complete verification in the OnlyFans API dashboard"),t(e=>e.map(e=>e.username===a?{...e,accountId:null}:e));return}let c=o.accountId;if(!c){alert("Connected but no account ID returned - check API dashboard"),t(e=>e.map(e=>e.username===a?{...e,accountId:null}:e));return}let l={...s,accountId:c,inRotation:!0};await i(l),t(e=>e.map(e=>e.username===a?l:e))}catch(e){alert("Connection failed: ".concat(e.message)),t(e=>e.map(e=>e.username===a?{...e,accountId:null}:e))}}},_=e.filter(e=>e.accountId&&"connecting..."!==e.accountId).length,P=e.filter(e=>e.inRotation&&e.accountId&&"connecting..."!==e.accountId).length;return a?(0,n.jsx)("div",{className:"min-h-screen bg-black text-white flex items-center justify-center",children:(0,n.jsx)("div",{className:"text-gray-400",children:"Loading network..."})}):(0,n.jsxs)("div",{className:"min-h-screen bg-black text-white",children:[(0,n.jsx)("div",{className:"border-b border-gray-800 p-4",children:(0,n.jsxs)("div",{className:"max-w-4xl mx-auto flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)(s.default,{href:"/",className:"text-gray-400 hover:text-white",children:"← Back"}),(0,n.jsx)("h1",{className:"text-xl font-bold",children:"\uD83D\uDD0C Network Management"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)("button",{onClick:A,disabled:(null==I?void 0:I.type)==="loading",className:"px-3 py-1.5 rounded text-sm font-medium transition ".concat((null==I?void 0:I.type)==="loading"?"bg-gray-700 text-gray-400":(null==I?void 0:I.type)==="success"?"bg-green-600 text-white":(null==I?void 0:I.type)==="error"?"bg-red-600 text-white":"bg-blue-600 hover:bg-blue-500 text-white"),children:(null==I?void 0:I.type)==="loading"?"⏳ Syncing...":(null==I?void 0:I.type)==="success"?"✓ Synced!":(null==I?void 0:I.type)==="error"?"✗ Error":"☁️ Sync to KV"}),I&&"loading"!==I.type&&(0,n.jsx)("span",{className:"text-xs ".concat("success"===I.type?"text-green-400":"text-red-400"),children:I.message}),c&&(0,n.jsxs)("div",{className:"text-sm",children:[(0,n.jsx)("span",{className:"text-gray-400",children:"API Credits:"})," ",(0,n.jsx)("span",{className:"text-green-400 font-mono",children:"number"==typeof c.balance?c.balance.toLocaleString():c.balance})]})]})]})}),(0,n.jsxs)("div",{className:"max-w-4xl mx-auto p-4 space-y-6",children:[(0,n.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,n.jsxs)("div",{className:"bg-gray-900 rounded-xl p-4 border border-gray-800",children:[(0,n.jsx)("div",{className:"text-3xl font-bold text-white",children:e.length}),(0,n.jsx)("div",{className:"text-gray-400 text-sm",children:"Total Models"})]}),(0,n.jsxs)("div",{className:"bg-gray-900 rounded-xl p-4 border border-gray-800",children:[(0,n.jsx)("div",{className:"text-3xl font-bold text-green-400",children:_}),(0,n.jsx)("div",{className:"text-gray-400 text-sm",children:"Connected to API"})]}),(0,n.jsxs)("div",{className:"bg-gray-900 rounded-xl p-4 border border-gray-800",children:[(0,n.jsx)("div",{className:"text-3xl font-bold text-blue-400",children:P}),(0,n.jsx)("div",{className:"text-gray-400 text-sm",children:"In Rotation"})]})]}),(0,n.jsx)("div",{className:"flex justify-end",children:(0,n.jsx)("button",{onClick:()=>{p(!0),v(null),w(null)},className:"px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg text-sm font-medium",children:"+ Add Model"})}),x&&(0,n.jsxs)("div",{className:"bg-gray-900 rounded-xl p-4 border border-green-800 space-y-4",children:[(0,n.jsx)("h3",{className:"font-semibold text-green-400",children:"Add New Model"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm text-gray-400 mb-1",children:"OF Username"}),(0,n.jsx)("input",{type:"text",value:b.username,onChange:e=>h(t=>({...t,username:e.target.value})),placeholder:"@username",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm text-gray-400 mb-1",children:"Display Name"}),(0,n.jsx)("input",{type:"text",value:b.displayName,onChange:e=>h(t=>({...t,displayName:e.target.value})),placeholder:"Model Name",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white"})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm text-gray-400 mb-1",children:"OF Email"}),(0,n.jsx)("input",{type:"email",value:b.email,onChange:e=>h(t=>({...t,email:e.target.value})),placeholder:"model@email.com",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block text-sm text-gray-400 mb-1",children:"OF Password"}),(0,n.jsx)("input",{type:"password",value:b.password,onChange:e=>h(t=>({...t,password:e.target.value})),placeholder:"••••••••",className:"w-full px-3 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white"})]})]}),N&&(0,n.jsxs)("div",{className:"p-3 bg-blue-900/30 border border-blue-700 rounded-lg text-blue-300 text-sm",children:["⏳ ",N]}),j&&(0,n.jsxs)("div",{className:"p-3 bg-red-900/30 border border-red-700 rounded-lg text-red-300 text-sm",children:["❌ ",j]}),(0,n.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,n.jsx)("button",{onClick:()=>{p(!1),v(null),w(null)},className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 rounded-lg text-sm",children:"Cancel"}),(0,n.jsx)("button",{onClick:C,disabled:!b.username||!b.displayName||!b.email||!b.password||y,className:"px-4 py-2 bg-green-600 hover:bg-green-700 rounded-lg text-sm font-medium disabled:opacity-50",children:y?"Connecting...":"Connect & Add"})]})]}),(0,n.jsx)("div",{className:"space-y-2",children:e.map(e=>(0,n.jsx)("div",{className:"bg-gray-900 rounded-xl p-4 border ".concat(e.accountId&&"connecting..."!==e.accountId?e.inRotation?"border-green-800":"border-yellow-800":"border-gray-800"),children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-4",children:[(0,n.jsx)("div",{className:"w-3 h-3 rounded-full ".concat("connecting..."===e.accountId?"bg-blue-500 animate-pulse":e.accountId?e.inRotation?"bg-green-500":"bg-yellow-500":"bg-gray-600")}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("span",{className:"font-medium text-white",children:e.displayName}),(0,n.jsxs)("span",{className:"text-gray-500",children:["@",e.username]})]}),(0,n.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"connecting..."===e.accountId?(0,n.jsx)("span",{className:"text-blue-400",children:"Connecting..."}):e.accountId?(0,n.jsx)("code",{className:"bg-gray-800 px-1 rounded",children:e.accountId}):(0,n.jsx)("span",{className:"text-yellow-500",children:"Not connected to API"})})]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[e.accountId&&"connecting..."!==e.accountId?(0,n.jsx)("button",{onClick:()=>k(e.username),className:"px-3 py-1.5 rounded-lg text-sm font-medium transition ".concat(e.inRotation?"bg-green-600 hover:bg-green-700 text-white":"bg-gray-700 hover:bg-gray-600 text-gray-300"),children:e.inRotation?"✓ In Rotation":"Paused"}):"connecting..."===e.accountId?(0,n.jsx)("span",{className:"px-3 py-1.5 bg-blue-600/50 rounded-lg text-sm text-blue-200",children:"Connecting..."}):(0,n.jsx)("button",{onClick:()=>O(e.username),className:"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 rounded-lg text-sm font-medium",children:"\uD83D\uDD17 Connect"}),(0,n.jsx)("button",{onClick:()=>D(e.username),className:"px-2 py-1.5 bg-red-600/20 hover:bg-red-600/40 rounded-lg text-red-400 text-sm",children:"\uD83D\uDDD1"})]})]})},e.username))}),(0,n.jsxs)("div",{className:"bg-gray-900 rounded-xl p-4 border border-gray-800 text-sm text-gray-400",children:[(0,n.jsx)("h3",{className:"font-semibold text-white mb-2",children:"\uD83D\uDCA1 How it works"}),(0,n.jsxs)("ul",{className:"space-y-1 list-disc list-inside",children:[(0,n.jsxs)("li",{children:[(0,n.jsx)("span",{className:"text-green-400",children:"Green"})," = Connected & in rotation (will post/receive promos)"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("span",{className:"text-yellow-400",children:"Yellow"})," = Connected but paused (no promos, saves API calls)"]}),(0,n.jsxs)("li",{children:[(0,n.jsx)("span",{className:"text-gray-400",children:"Gray"})," = Not connected - click Connect to add credentials"]}),(0,n.jsxs)("li",{children:["If 2FA is required, you'll need to verify in the ",(0,n.jsx)("a",{href:"https://app.onlyfansapi.com",target:"_blank",className:"text-blue-400 hover:underline",children:"OnlyFans API Dashboard"})]})]})]})]})]})}},251:function(e,t,a){"use strict";a.d(t,{EY:function(){return o},TU:function(){return l},lL:function(){return s},xA:function(){return c},yn:function(){return d}});let n="promo_images";function r(){return new Promise((e,t)=>{let a=indexedDB.open("s4s_promo_db",1);a.onerror=()=>t(a.error),a.onsuccess=()=>e(a.result),a.onupgradeneeded=e=>{let t=e.target.result;t.objectStoreNames.contains(n)||t.createObjectStore(n,{keyPath:"username"})}})}async function s(e){try{let t=await r();return new Promise((a,r)=>{let s=t.transaction(n,"readonly").objectStore(n).get(e);s.onerror=()=>r(s.error),s.onsuccess=()=>{let e=s.result;a((null==e?void 0:e.images)||[])}})}catch(t){return console.error("Failed to load from IndexedDB:",t),function(e){try{let t=localStorage.getItem("s4s_promo_images");if(!t)return[];return JSON.parse(t)[e]||[]}catch(e){return[]}}(e)}}async function o(e,t){try{let a=await r();return new Promise((r,s)=>{let o=a.transaction(n,"readwrite").objectStore(n).put({username:e,images:t});o.onerror=()=>s(o.error),o.onsuccess=()=>r()})}catch(e){throw console.error("Failed to save to IndexedDB:",e),e}}async function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15;try{let t=await r();return new Promise((a,r)=>{let s=t.transaction(n,"readonly").objectStore(n).getAll();s.onerror=()=>r(s.error),s.onsuccess=()=>{let t={},n=e-1;for(let e of s.result){let a=e.images.filter(e=>e.isActive),r=!1,s=n,o=0;for(let e of a){let t=Object.keys(e.vaultIds||{}).length;t<n&&(r=!0),s=Math.min(s,t),o=Math.max(o,t)}let c="";0===a.length?(c="No active images",r=!0):c=r?"".concat(s,"/").concat(n," vaults"):"✓ All ".concat(n," vaults"),t[e.username]={total:e.images.length,active:a.length,needsDistribution:r,vaultStatus:c}}a(t)}})}catch(e){return console.error("Failed to get image counts:",e),{}}}async function l(){try{let e=localStorage.getItem("s4s_promo_images");if(!e)return 0;let t=JSON.parse(e),a=0;for(let[e,n]of Object.entries(t))n&&n.length>0&&(await o(e,n),a+=n.length);return a>0&&(localStorage.removeItem("s4s_promo_images"),console.log("Migrated ".concat(a," images from localStorage to IndexedDB"))),a}catch(e){return console.error("Migration failed:",e),0}}async function i(){try{let e=await r();return new Promise((t,a)=>{let r=e.transaction(n,"readonly").objectStore(n).getAll();r.onerror=()=>a(r.error),r.onsuccess=()=>{let e={},a=[];for(let t of r.result)for(let n of(a.push(t.username),t.images))if(n.isActive)for(let[a,r]of Object.entries(n.vaultIds||{}))e[a]||(e[a]={}),e[a][t.username]=r;t({mappings:e,models:a})}})}catch(e){return console.error("Failed to export vault mappings:",e),{mappings:{},models:[]}}}async function d(){try{let{mappings:e,models:t}=await i(),a=await fetch("/api/sync/vault-mappings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mappings:e,models:t})}),n=await a.json();if(n.success)return{success:!0,message:"Synced ".concat(t.length," models with ").concat(n.totalVaultIds," vault mappings")};return{success:!1,message:n.error||"Sync failed"}}catch(e){return{success:!1,message:String(e)}}}}},function(e){e.O(0,[792,971,69,744],function(){return e(e.s=8404)}),_N_E=e.O()}]);
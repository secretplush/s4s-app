# 2026-02-12 — Major S4S App & Railway Updates

## Exclude Lists
- Created 23 new "SFS Exclude List 2.0" via OF API for models missing them
- Fixed oliviabrookess (was sharing jessicaparkerrr's ID), chloecookk & ayaaann (wrong IDs)
- All 50 models now have exclude list IDs in Railway `SFS_EXCLUDE_LISTS`
- laceythomass uses list `1260552953` named "❌ no promo" (15 users) — Kiefer confirmed keep it

## Railway Deployment
- `railway up --detach` works (Railway CLI installed, logged in as kiefer@erotiqa.co)
- SSH deploy key for s4s-rotation-service doesn't have write access — can't git push
- Generated new key `id_s4s_rotation` but never added to GitHub (Kiefer didn't want to deal with it)
- Use `railway up` instead of git push for rotation service deploys

## Auto-Resume Ghost Tags
- Added `s4s:rotation-enabled` Redis key — persists on start/stop
- `startupRecovery()` now auto-resumes ghost tags if enabled — no more manual Start after deploys
- Mass DMs already auto-resumed, pinned posts on daily cron

## Dynamic Pinned Posts Formula
- Changed from hardcoded `PINNED_FEATURED_PER_DAY = 10` to `Math.floor(targetableModels.length / 5)`
- 50 models → 10 featured × 5 pages, 56 models → 11 × 5, etc.
- Kiefer confirmed: "Number of models/5 = number of models selected for rotation on any given day"

## Dashboard Overhaul
- Stripped rotation page from 550 → ~310 lines — removed all stale client-side sections
- Unified live ops dashboard: 3 columns (ghost tags, pinned posts, mass DMs) with Railway data
- Added toggle switches per system (independent on/off for each)
- Added live feeds: ghost tags + mass DMs side by side with real-time Railway data
- Added `/feed/mass-dm` and `/feed/ghost-tags` endpoints to Railway (in-memory, last 100)
- Fixed `/active` endpoint to filter tags >10 min old (was showing stuck 2-day-old tag)
- Replaced stale dashboard cards on main page with live S4S status from Railway
- Removed: test single tag, preview mode, stale stat cards, hour distribution, full schedule, how it works

## Earnings/LTV
- `/api/earnings` route fetches from `/statistics/overview` endpoint (not `statements/earnings`)
- `statements/earnings` returns tiny numbers (wrong endpoint)
- `statistics/overview` returns real totals: net (earning.total) and gross (earning.gross)
- Using NET earnings per Kiefer's request
- Cached in KV for 1 hour, POST to force refresh
- taylorskully: $2.27M net, kybabyrae: $3.41M, saralovexx: $3.13M
- Had to bust localStorage cache multiple times (bumped to v3)

## Captions
- Added 30 pinned post captions (college/free VIP/just turned 18 theme, casual girl tone)
- Added 30 ghost tag captions (same theme)
- Added mass DM captions tab to captions page (40 captions from Railway)
- Captions page now shows all 3 categories with tabs
- Total: 58 ghost + 46 pinned + 40 mass DM = 144 templates

## Kiefer's Vision for Model Management
- Wants self-service admin page: add/remove models, upload photos, set roles, configure exclude lists
- "Things are dynamic" — models change daily, can't go back and forth with Jack
- Model roles: full rotation / promoter only / receive only
- Per-model tag count, number of photos, etc.
- Everything auto-syncs to Railway — no code changes, no deploys

## Competitor Promo Source Research (Paused)
- Kiefer wants to find competitor's promo sources on Gig Social
- Strategy: subscribe to shoutout sellers (free), check friends list for competitor's 113 models
- Friends lists are unidirectional — have to find the source accounts first
- Paused to work on dashboard/captions instead

## Business Math
- $1/guaranteed sub, $20 LTV, 70/30 model/agency split
- Agency profit: $5/sub (or $5.70 if splitting promo cost 70/30 too)
